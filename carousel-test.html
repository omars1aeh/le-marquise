<!DOCTYPE html>
<html>
<head>
    <title>Carousel Test</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 40px;
            background: #f5f5f5;
        }

        .carousel {
            position: relative;
            max-width: 700px;
            margin: 40px auto;
            padding: 0 80px;
            background: white;
            border-radius: 8px;
        }

        .carousel .viewport {
            overflow: hidden;
            position: relative;
            width: 100%;
            min-height: 400px;
            background: #eee; /* Debug background */
        }

        .carousel .track {
            position: relative;
            width: 100%;
            min-height: 400px;
            background: #ddd; /* Debug background */
        }

        .carousel .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: transform 0.4s ease, opacity 0.4s ease;
            will-change: transform, opacity;
            padding: 20px;
            box-sizing: border-box;
            background: white; /* Debug background */
            border: 2px solid red; /* Debug border */
        }

        .carousel .arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            cursor: pointer;
            color: #c9a961;
            padding: 0;
            margin: 0;
            z-index: 10;
            font-size: 48px;
        }

        .carousel .arrow:hover {
            color: #d4b76d;
            transform: translateY(-50%) scale(1.15);
        }

        .carousel .arrow.prev {
            left: 0;
        }

        .carousel .arrow.next {
            right: 0;
        }

        .company-logo-box {
            width: 100%;
            max-width: 400px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            border-radius: 8px;
            margin-bottom: 20px;
            padding: 20px;
        }

        .company-logo-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        h3 {
            font-size: 1.5rem;
            margin: 0;
        }
    </style>
</head>
<body>
    <h1>Carousel Debug Test</h1>

    <div class="carousel" id="testCarousel">
        <button type="button" class="arrow prev">‹</button>
        <div class="viewport">
            <div class="track">
                <!-- Slides will be injected -->
            </div>
        </div>
        <button type="button" class="arrow next">›</button>
    </div>

    <div id="debug"></div>

    <script>
        console.log('Test page loaded');

        function makeCarousel(rootEl, items, renderSlide) {
            console.log('makeCarousel called');

            const track = rootEl.querySelector('.track');
            const prevBtn = rootEl.querySelector('.arrow.prev');
            const nextBtn = rootEl.querySelector('.arrow.next');

            console.log({ track, prevBtn, nextBtn });

            let currentIndex = 0;

            function init() {
                console.log('init() - creating slides');
                track.innerHTML = '';

                items.forEach((item, index) => {
                    const slideDiv = document.createElement('div');
                    slideDiv.className = 'slide';
                    slideDiv.innerHTML = renderSlide(item);
                    slideDiv.setAttribute('data-index', index);
                    track.appendChild(slideDiv);
                    console.log(`Created slide ${index}:`, slideDiv);
                });

                render();
            }

            function render() {
                const slides = track.querySelectorAll('.slide');
                console.log(`render() - ${slides.length} slides, currentIndex=${currentIndex}`);

                slides.forEach((slide, i) => {
                    const prevIndex = (currentIndex - 1 + slides.length) % slides.length;

                    if (i === currentIndex) {
                        slide.style.transform = 'translateX(0%)';
                        slide.style.opacity = '1';
                        slide.style.zIndex = '2';
                        console.log(`Slide ${i}: ACTIVE`);
                    } else if (i === prevIndex) {
                        slide.style.transform = 'translateX(-100%)';
                        slide.style.opacity = '0.35';
                        slide.style.zIndex = '1';
                        console.log(`Slide ${i}: PREVIOUS`);
                    } else {
                        slide.style.transform = 'translateX(100%)';
                        slide.style.opacity = '0';
                        slide.style.zIndex = '0';
                        console.log(`Slide ${i}: HIDDEN`);
                    }
                });

                // Update debug info
                document.getElementById('debug').innerHTML =
                    `<p>Current index: ${currentIndex} / ${slides.length}</p>`;
            }

            function next() {
                currentIndex = (currentIndex + 1) % items.length;
                console.log('next() -> index', currentIndex);
                render();
            }

            function prev() {
                currentIndex = (currentIndex - 1 + items.length) % items.length;
                console.log('prev() -> index', currentIndex);
                render();
            }

            if (prevBtn) {
                prevBtn.addEventListener('click', prev);
            }

            if (nextBtn) {
                nextBtn.addEventListener('click', next);
            }

            init();
        }

        // Test data
        const companies = [
            { name: 'Al Dahan Al Masi', img: 'images/Dahan_no_bg.png' },
            { name: 'Haven House', img: 'images/HH Vertical_no_bg.png' },
            { name: 'Off White', img: 'images/Off White.jpeg' },
            { name: 'ZEE Production House', img: 'images/ZEE_no_bg.png' }
        ];

        function renderCompanySlide(item) {
            return `
                <div class="company-logo-box">
                    <img src="${item.img}" alt="${item.name}" onerror="console.error('Image failed:', this.src)">
                </div>
                <h3>${item.name}</h3>
            `;
        }

        // Initialize
        const carousel = document.getElementById('testCarousel');
        makeCarousel(carousel, companies, renderCompanySlide);
    </script>
</body>
</html>
